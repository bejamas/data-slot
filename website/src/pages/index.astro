---
import { Code } from "astro:components";
import Layout from "../layouts/Layout.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import PackagesTable from "../components/PackagesTable.astro";

// Example components
import TabsBasic from "../components/examples/TabsBasic.astro";
import TabsIndicator from "../components/examples/TabsIndicator.astro";
import AccordionSingle from "../components/examples/AccordionSingle.astro";
import AccordionMultiple from "../components/examples/AccordionMultiple.astro";
import Dialog from "../components/examples/Dialog.astro";
import Collapsible from "../components/examples/Collapsible.astro";
import Tooltip from "../components/examples/Tooltip.astro";
import Popover from "../components/examples/Popover.astro";
import NavigationMenu from "../components/examples/NavigationMenu.astro";
import DropdownMenu from "../components/examples/DropdownMenu.astro";

const quickStartHtml = `<div data-slot="tabs" data-default-value="one">
  <div data-slot="tabs-list">
    <button data-slot="tabs-trigger" data-value="one">Tab One</button>
    <button data-slot="tabs-trigger" data-value="two">Tab Two</button>
  </div>
  <div data-slot="tabs-content" data-value="one">Content One</div>
  <div data-slot="tabs-content" data-value="two">Content Two</div>
</div>`;

const quickStartCode = `import { create } from "@data-slot/tabs";

// Auto-discover and bind all [data-slot="tabs"] elements
const controllers = create();

// Or target a specific element
import { createTabs } from "@data-slot/tabs";
const tabs = createTabs(element);

tabs.select("two");   // programmatic control
tabs.destroy();       // cleanup`;

const stylingCode = `/* State-based styling */
[data-state="active"]   { ... }
[data-state="open"]     { ... }
[aria-expanded="true"] { ... }
[aria-selected="true"] { ... }

/* With Tailwind */
<button class="aria-selected:font-bold">Tab</button>`;

const apiCode = `// Auto-bind all instances
import { create } from "@data-slot/[component]";
const controllers = create(scope?);

// Create for specific element
import { createDialog } from "@data-slot/dialog";
const dialog = createDialog(element, options?);

// Common controller methods
controller.destroy(); // cleanup listeners`;
---

<Layout
  title="data-slot - headless UI for vanilla JavaScript"
  description="Headless UI components for vanilla JavaScript. Tiny, accessible, unstyled."
>
  <Header />

  <div class="text-border my-8">~~~</div>

  <!-- Packages Table -->
  <h2 class="text-base font-medium mt-12 mb-4 text-[#666] before:content-['##_'] before:text-border">PACKAGES</h2>
  <PackagesTable />

  <!-- Installation -->
  <h2 class="text-base font-medium mt-12 mb-4 text-[#666] before:content-['##_'] before:text-border">INSTALLATION</h2>
  <p class="my-4">Install only what you need:</p>
  <div class="code-block">
    <Code
      code={`bun add @data-slot/tabs
bun add @data-slot/dialog`}
      lang="bash"
      theme="vitesse-light"
    />
  </div>

  <!-- Quick Start -->
  <h2 class="text-base font-medium mt-12 mb-4 text-[#666] before:content-['##_'] before:text-border">QUICK START</h2>
  <p class="my-4">
    Components use <code class="bg-[#f0eeeb] px-1.5 py-0.5">data-slot</code> attributes for markup:
  </p>
  <div class="code-block">
    <Code code={quickStartHtml} lang="html" theme="vitesse-light" />
  </div>
  <p class="my-4">
    Import and call <code class="bg-[#f0eeeb] px-1.5 py-0.5">create()</code> to bind behavior:
  </p>
  <div class="code-block">
    <Code code={quickStartCode} lang="javascript" theme="vitesse-light" />
  </div>

  <div class="text-border my-8">~~~</div>

  <!-- Live Demos -->
  <h2 class="text-base font-medium mt-12 mb-4 text-[#666] before:content-['##_'] before:text-border">LIVE DEMOS</h2>
  <p class="my-4">Interactive examples using the library. Inspect the source for markup patterns.</p>

  <!-- Tabs -->
  <h3 class="text-base font-medium mt-8 mb-3 before:content-['###_'] before:text-border">Tabs</h3>
  <TabsBasic />
  <TabsIndicator />

  <!-- Accordion -->
  <h3 class="text-base font-medium mt-8 mb-3 before:content-['###_'] before:text-border">Accordion</h3>
  <AccordionSingle />
  <AccordionMultiple />

  <!-- Dialog -->
  <h3 class="text-base font-medium mt-8 mb-3 before:content-['###_'] before:text-border">Dialog</h3>
  <Dialog />

  <!-- Collapsible -->
  <h3 class="text-base font-medium mt-8 mb-3 before:content-['###_'] before:text-border">Collapsible</h3>
  <Collapsible />

  <!-- Tooltip -->
  <h3 class="text-base font-medium mt-8 mb-3 before:content-['###_'] before:text-border">Tooltip</h3>
  <Tooltip />

  <!-- Popover -->
  <h3 class="text-base font-medium mt-8 mb-3 before:content-['###_'] before:text-border">Popover</h3>
  <Popover />

  <!-- Navigation Menu -->
  <h3 class="text-base font-medium mt-8 mb-3 before:content-['###_'] before:text-border">Navigation Menu</h3>
  <NavigationMenu />

  <!-- Dropdown Menu -->
  <h3 class="text-base font-medium mt-8 mb-3 before:content-['###_'] before:text-border">Dropdown Menu</h3>
  <DropdownMenu />

  <div class="text-border my-8">~~~</div>

  <!-- Styling Guide -->
  <h2 class="text-base font-medium mt-12 mb-4 text-[#666] before:content-['##_'] before:text-border">STYLING</h2>
  <p class="my-4">
    Components expose <code class="bg-[#f0eeeb] px-1.5 py-0.5">data-state</code> and ARIA attributes for CSS hooks:
  </p>
  <div class="code-block">
    <Code code={stylingCode} lang="css" theme="vitesse-light" />
  </div>

  <!-- API Reference -->
  <h2 class="text-base font-medium mt-12 mb-4 text-[#666] before:content-['##_'] before:text-border">API</h2>
  <p class="my-4">All components follow the same pattern:</p>
  <div class="code-block">
    <Code code={apiCode} lang="javascript" theme="vitesse-light" />
  </div>

  <Footer />
</Layout>

<style>
  /* Shiki code blocks styling */
  .code-block :global(.astro-code) {
    background: #f0eeeb !important;
    padding: 1rem;
    overflow-x: auto;
    margin: 0.5rem 0;
    border-left: 3px solid #ccc;
    font-size: 0.85rem;
  }

  .code-block :global(.astro-code code) {
    background: none;
    padding: 0;
  }
</style>

<script>
  // Import component libraries from parent dist
  import { createTabs } from "@data-slot/tabs";
  import { createAccordion } from "@data-slot/accordion";
  import { createDialog } from "../../../packages/dialog/dist/index.js";
  import { createCollapsible } from "../../../packages/collapsible/dist/index.js";
  import { createTooltip } from "@data-slot/tooltip";
  import { createPopover } from "@data-slot/popover";
  import { createNavigationMenu } from "@data-slot/navigation-menu";
  import { createDropdownMenu } from "../../../packages/dropdown-menu/dist/index.js";

  // Initialize all components
  document.querySelectorAll('[data-slot="tabs"]').forEach((el) => createTabs(el as HTMLElement));

  // Accordions: single mode (default) vs multiple mode
  // CSS versions
  const accordionSingleCss = document.getElementById("accordion-single-css");
  const accordionMultipleCss = document.getElementById("accordion-multiple-css");
  if (accordionSingleCss) createAccordion(accordionSingleCss);
  if (accordionMultipleCss) createAccordion(accordionMultipleCss, { multiple: true });
  // Tailwind versions
  const accordionSingleTw = document.getElementById("accordion-single-tw");
  const accordionMultipleTw = document.getElementById("accordion-multiple-tw");
  if (accordionSingleTw) createAccordion(accordionSingleTw);
  if (accordionMultipleTw) createAccordion(accordionMultipleTw, { multiple: true });

  // Dialogs
  document.querySelectorAll('[data-slot="dialog"]').forEach((el) =>
    createDialog(el as HTMLElement, { closeOnClickOutside: true })
  );

  // Other components
  document.querySelectorAll('[data-slot="collapsible"]').forEach((el) =>
    createCollapsible(el as HTMLElement)
  );
  document.querySelectorAll('[data-slot="tooltip"]').forEach((el) =>
    createTooltip(el as HTMLElement, { delay: 300 })
  );
  document.querySelectorAll('[data-slot="popover"]').forEach((el) =>
    createPopover(el as HTMLElement)
  );
  document.querySelectorAll('[data-slot="navigation-menu"]').forEach((el) =>
    createNavigationMenu(el as HTMLElement)
  );
  document.querySelectorAll('[data-slot="dropdown-menu"]').forEach((el) =>
    createDropdownMenu(el as HTMLElement )
  );
</script>
