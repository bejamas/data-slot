---
import { Code } from "astro:components";
import ExampleBlock from "../ExampleBlock.astro";

const cssCode = `<div data-slot="popover" class="popover-root">
  <button data-slot="popover-trigger" class="popover-trigger-btn">Open Popover</button>
  <div data-slot="popover-content" data-side="bottom" data-align="center" class="popover-content" hidden>
    <div class="popover-title">Popover Panel</div>
    <p class="popover-text">
      Unlike tooltips, popovers stay open until dismissed.
      Click outside or press Escape to close.
    </p>
    <button data-slot="popover-close" class="popover-close-btn">Got it</button>
  </div>
</div>

<style>
  .popover-root { display: inline-block; }
  .popover-trigger-btn {
    padding: 0.5rem 1rem;
    background: #1a1a1a;
    color: #faf9f7;
    border: none;
    cursor: pointer;
  }
  .popover-content {
    position: fixed;
    background: #faf9f7;
    border: 1px solid #ccc;
    padding: 1rem;
    width: min(20rem, calc(100vw - 2rem));
    z-index: 50;
    transform-origin: var(--transform-origin, center);
    --popover-slide-x: 0px;
    --popover-slide-y: -4px;
  }
  .popover-content[data-side="top"] {
    --popover-slide-y: 4px;
  }
  .popover-content[data-side="bottom"] {
    --popover-slide-y: -4px;
  }
  .popover-content[data-side="left"] {
    --popover-slide-x: 4px;
    --popover-slide-y: 0px;
  }
  .popover-content[data-side="right"] {
    --popover-slide-x: -4px;
    --popover-slide-y: 0px;
  }
  .popover-content[data-open] {
    animation: popover-in 160ms cubic-bezier(0.16, 1, 0.3, 1);
  }
  .popover-content[data-closed] {
    pointer-events: none;
    animation: popover-out 120ms ease-in forwards;
  }
  @keyframes popover-in {
    from {
      opacity: 0;
      scale: 0.96;
      translate: var(--popover-slide-x) var(--popover-slide-y);
    }
    to {
      opacity: 1;
      scale: 1;
      translate: 0 0;
    }
  }
  @keyframes popover-out {
    from {
      opacity: 1;
      scale: 1;
      translate: 0 0;
    }
    to {
      opacity: 0;
      scale: 0.96;
      translate: var(--popover-slide-x) var(--popover-slide-y);
    }
  }
  .popover-title { font-weight: 700; margin-bottom: 0.5rem; }
  .popover-text { color: #666; font-size: 0.9rem; margin-bottom: 0.75rem; }
  .popover-close-btn {
    padding: 0.3rem 0.6rem;
    background: none;
    border: 1px solid #ccc;
    cursor: pointer;
  }
</style>`;

const tailwindCode = `<div data-slot="popover" class="relative inline-block">
  <button
    data-slot="popover-trigger"
    class="px-4 py-2 bg-gray-900 text-white border-none cursor-pointer
           hover:opacity-90 transition-opacity"
  >
    Open Popover
  </button>
  <div
    data-slot="popover-content"
    data-side="bottom"
    data-align="center"
    class="fixed bg-white border border-gray-300
           p-4 w-80 max-w-[calc(100vw-2rem)] z-50 rounded-lg shadow-lg"
    hidden
  >
    <div class="font-bold mb-2 mt-0">Popover Panel</div>
    <p class="text-gray-500 text-sm mb-3">
      Unlike tooltips, popovers stay open until dismissed.
      Click outside or press Escape to close.
    </p>
    <button
      data-slot="popover-close"
      class="px-2.5 py-1 bg-transparent border border-gray-300
             cursor-pointer hover:bg-code-bg transition-colors"
    >
      Got it
    </button>
  </div>
</div>

/* State-based animation (works with presence lifecycle) */
[data-slot="popover-content"] {
  transform-origin: var(--transform-origin, center);
  --popover-slide-x: 0px;
  --popover-slide-y: -4px;
}
[data-slot="popover-content"][data-side="top"] {
  --popover-slide-y: 4px;
}
[data-slot="popover-content"][data-side="bottom"] {
  --popover-slide-y: -4px;
}
[data-slot="popover-content"][data-side="left"] {
  --popover-slide-x: 4px;
  --popover-slide-y: 0px;
}
[data-slot="popover-content"][data-side="right"] {
  --popover-slide-x: -4px;
  --popover-slide-y: 0px;
}
[data-slot="popover-content"][data-open] {
  animation: popover-in 160ms cubic-bezier(0.16, 1, 0.3, 1);
}
[data-slot="popover-content"][data-closed] {
  pointer-events: none;
  animation: popover-out 120ms ease-in forwards;
}
@keyframes popover-in {
  from {
    opacity: 0;
    scale: 0.96;
    translate: var(--popover-slide-x) var(--popover-slide-y);
  }
  to {
    opacity: 1;
    scale: 1;
    translate: 0 0;
  }
}
@keyframes popover-out {
  from {
    opacity: 1;
    scale: 1;
    translate: 0 0;
  }
  to {
    opacity: 0;
    scale: 0.96;
    translate: var(--popover-slide-x) var(--popover-slide-y);
  }
}`;
---

<ExampleBlock>
  <div slot="preview-css" data-slot="popover" class="popover-root" id="popover-css">
    <button data-slot="popover-trigger" class="popover-trigger-btn">Open Popover</button>
    <div data-slot="popover-content" data-side="bottom" data-align="center" class="popover-content" hidden>
      <div class="popover-title">Popover Panel</div>
      <p class="popover-text">
        Unlike tooltips, popovers stay open until dismissed.
        Click outside or press Escape to close.
      </p>
      <button data-slot="popover-close" class="popover-close-btn">Got it</button>
    </div>
  </div>
  <div slot="preview-tailwind" data-slot="popover" class="relative inline-block" id="popover-tw">
    <button
      data-slot="popover-trigger"
      class="px-4 py-2 bg-gray-900 text-white border-none cursor-pointer hover:opacity-90 transition-opacity"
    >
      Open Popover
    </button>
    <div
      data-slot="popover-content"
      data-side="bottom"
      data-align="center"
      class="fixed bg-white border border-gray-300 p-4 w-80 max-w-[calc(100vw-2rem)] z-50 rounded-lg shadow-lg"
      hidden
    >
      <div class="font-bold mb-2 mt-0">Popover Panel</div>
      <p class="text-gray-500 text-sm mb-3">
        Unlike tooltips, popovers stay open until dismissed.
        Click outside or press Escape to close.
      </p>
      <button
        data-slot="popover-close"
        class="px-2.5 py-1 bg-transparent border border-gray-300 cursor-pointer hover:bg-code-bg transition-colors"
      >
        Got it
      </button>
    </div>
  </div>
  <Code slot="code-css" code={cssCode} lang="html" theme="vitesse-light" />
  <Code slot="code-tailwind" code={tailwindCode} lang="html" theme="vitesse-light" />
</ExampleBlock>
